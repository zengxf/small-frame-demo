## Conv2d 测试 - K1

### 参考

- https://chat.qwen.ai/c/3a51a250-b8a7-4545-a54b-1f1958baa493

### 输出说明

#### x1_1_2_2_2-in_2-out_1-k_1_1-test.py

- ref: [test.py](x1_1_2_2_2-in_2-out_1-k_1_1-test.py)
- 测试 PyTorch Conv2d：2 in, 1 out, 1x1 kernel

每个空间位置 `(i, j)` 的输出计算方式为：

```
output[i, j] = weight[0] * input_ch0[i, j] + weight[1] * input_ch1[i, j]
              = 1.0 * ch0[i,j] + 2.0 * ch1[i,j]
```

所以：

- 左上角：`1*1 + 2*5 = 11`
- 右上角：`1*2 + 2*6 = 14`
- 左下角：`1*3 + 2*7 = 17`
- 右下角：`1*4 + 2*8 = 20`

**实际输出**：

```
输出 feature map:
 tensor([[11., 14.],
         [17., 20.]])
```

#### x1_1_2_2_2-in_2-out_2-k_1_1-test.py

- ref: [test.py](x1_1_2_2_2-in_2-out_2-k_1_1-test.py)
- 测试 PyTorch Conv2d：2 in, 2 out, 1x1 kernel

对每个空间位置 `(i, j)`：

- **输出通道 0** = `1.0 * ch0[i,j] + 0.5 * ch1[i,j]`
- **输出通道 1** = `-1.0 * ch0[i,j] + 2.0 * ch1[i,j]`

逐元素计算：

| 位置    | ch0 | ch1 | out0 = 1×ch0 + 0.5×ch1 | out1 = -1×ch0 + 2×ch1 |
|-------|-----|-----|------------------------|-----------------------|
| (0,0) | 1   | 5   | 1 + 2.5 = **3.5**      | -1 + 10 = **9.0**     |
| (0,1) | 2   | 6   | 2 + 3 = **5.0**        | -2 + 12 = **10.0**    |
| (1,0) | 3   | 7   | 3 + 3.5 = **6.5**      | -3 + 14 = **11.0**    |
| (1,1) | 4   | 8   | 4 + 4 = **8.0**        | -4 + 16 = **12.0**    |

**因此输出为：**

```
输出通道 0:
 tensor([[3.5, 5.0],
         [6.5, 8.0]])

输出通道 1:
 tensor([[ 9., 10.],
         [11., 12.]])
```

#### x1_1_2_2_2-in_2-out_3-k_1_1-test.py

- ref: [test.py](x1_1_2_2_2-in_2-out_3-k_1_1-test.py)
- 测试 PyTorch Conv2d：2 in, 3 out, 1x1 kernel

每个空间位置 `(i, j)` 的输出由下式计算：

```
out[k, i, j] = weight[k, 0] * x[0, i, j] + weight[k, 1] * x[1, i, j]
```

根据我们设定的权重：

- **输出通道 0** = `1.0 * ch0 + 0.0 * ch1` → 直接复制通道 0
- **输出通道 1** = `0.0 * ch0 + 1.0 * ch1` → 直接复制通道 1
- **输出通道 2** = `1.0 * ch0 + 1.0 * ch1` → 两通道相加

因此输出为：

```
输出通道 0:
 tensor([[1., 2.],
         [3., 4.]])

输出通道 1:
 tensor([[5., 6.],
         [7., 8.]])

输出通道 2:
 tensor([[ 6.,  8.],
         [10., 12.]])
```

（因为 1+5=6, 2+6=8, 3+7=10, 4+8=12）